!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("breeze-client")):"function"==typeof define&&define.amd?define("breeze-client/mixin-get-entity-graph",["exports","breeze-client"],t):t(((e=e||self)["breeze-client"]=e["breeze-client"]||{},e["breeze-client"]["mixin-get-entity-graph"]={}),e["breeze-client"])}(this,(function(e,t){"use strict";function n(e){var n=t.EntityManager.prototype;n.getEntityGraph||(n.getEntityGraph=r)}function r(e,n){return e instanceof t.EntityQuery?i(this.executeQueryLocally(e),n||e.expandClause):i(e,n)}function i(e,n){var r,i,a=[],o=Array.isArray(e)?e:[e];return f(o),(o=a.slice()).length&&(function(){var e;function n(e,t){return new Error("'getEntityGraph' root["+e+"] "+t)}o.forEach((function(a,o){var f;if(!a||!(f=a.entityAspect))throw n(o,"is not an entity");if(f.entityState===t.EntityState.Detached)throw n(o,"is a detached entity");var y=f.entityManager;if(r){if(r!==y._entityGroupMap)throw n(o,"has a different 'EntityManager' than other roots")}else r=y._entityGroupMap;!function(t,r){var a=t.entityType;if(i){if(i!==a){var o=i;do{if((e=e||o.getSelfAndSubtypes()).indexOf(a)>-1)return void(i=o);o=o.baseEntityType,e=null}while(o);o=a;do{if((e=o.getSelfAndSubtypes()).indexOf(i)>-1)return void(i=o);o=o.baseEntityType}while(o);throw n(r,"is not EntityType-compatible with other roots")}}else i=a}(a,o)}))}(),function(){try{if(n?"string"==typeof n&&(n=(new t.EntityQuery).expand(n).expandClause):n=[],n instanceof t.ExpandClause&&n.propertyPaths)n=n.propertyPaths;else{if(!Array.isArray(n))throw"";if(!n.every((function(e){return"string"==typeof e})))throw""}}catch(e){throw new Error("expand must be an expand string, array of string paths, or a query expand clause")}}(),function(){if(n&&n instanceof Array&&n.length){n.map(y).forEach((function(e){e(o)}))}}()),a;function f(e){e.forEach((function(e){e&&a.indexOf(e)<0&&a.push(e)}))}function y(e){for(var t=[],n=e.split("."),r=i,a=0,o=n.length;a<o;a++){var y=u(r,n[a]);r=y.navType,t.push(y)}return function(e){for(var n=0,r=t.length;n<r;n++){var i=e.length;if(0===i)return;for(var a=t[n],o=[],y=0;y<i;y++)o=o.concat(a(e[y]));if(f(o),n>=r-1)return;e=[];for(var u=0,c=o.length;u<c;u++){var s=o[u];e.indexOf(s)<0&&e.push(s)}}}}function u(e,t){var n,i,a=void 0;try{n=e.name;var o=e.getNavigationProperty(t),f=o.foreignKeyNames[0];if(!o)throw new Error(t+" is not a navigation property of "+n);var y=(i=o.entityType).getSelfAndSubtypes(),u=[];y.forEach((function(e){var t=r[e.name];t&&t._entities.length>0&&u.push(t)}));var c=u.length;if(0===c)a=function(){return[]};else if(f)a=function(e){var t=null;try{for(var n=e.getProperty(f),r=0;r<c&&!(t=u[r]._entities[u[r]._indexMap[n]]);r+=1);}catch(e){s(e)}return t};else{if(!(f=o.inverse?o.inverse.foreignKeyNames[0]:o.invForeignKeyNames[0]))throw new Error("No inverse keys");a=function(e){var t=[];try{var n=e.entityAspect.getKey().values[0];u.forEach((function(e){t=t.concat(e._entities.filter((function(e){return e&&e.getProperty(f)===n})))}))}catch(e){s(e)}return t}}a.navType=i,a.path=t}catch(e){s(e)}return a;function s(r){var i=new Error("'getEntityGraph' can't expand '"+t+"' for "+(n||e));throw i.innerError=r,i}}}n(t.EntityManager),e.mixinEntityGraph=n,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=breeze-client-mixin-get-entity-graph.umd.min.js.map
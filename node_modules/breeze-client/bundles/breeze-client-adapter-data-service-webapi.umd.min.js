!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("breeze-client")):"function"==typeof define&&define.amd?define("breeze-client/adapter-data-service-webapi",["exports","breeze-client"],t):t(((e=e||self)["breeze-client"]=e["breeze-client"]||{},e["breeze-client"]["adapter-data-service-webapi"]={}),e["breeze-client"])}(this,(function(e,t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};var n=function(e){function n(){var a=e.call(this)||this;return a.jsonResultsAdapter=new t.JsonResultsAdapter({name:"webApi_default",visitNode:function(e,a,n){if(null==e)return{};var r=t.MetadataStore.normalizeTypeName(e.$type),i=r&&a.entityManager.metadataStore.getEntityType(r,!0),p=n.propertyName,o=p&&"$"===p.substr(0,1);return{entityType:i,nodeId:e.$id,nodeRefId:e.$ref,ignore:o}}}),a.name="webApi",a}return function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,e),n.register=function(e){return(e=e||t.config).registerAdapter("dataService",n),e.initializeAdapterInstance("dataService","webApi",!0)},n.prototype._prepareSaveBundle=function(e,a){var n=this._createChangeRequestInterceptor(e,a),r=e.entityManager,i=r.metadataStore,p=r.helper,o={};return o.entities=a.entities.map((function(e,a){var r,o=p.unwrapInstance(e);e.entityType.autoGeneratedKeyType!==t.AutoGeneratedKeyType.None&&(r={propertyName:e.entityType.keyProperties[0].nameOnServer,autoGeneratedKeyType:e.entityType.autoGeneratedKeyType.name});var y=p.unwrapOriginalValues(e,i);return o.entityAspect={entityTypeName:e.entityType.name,defaultResourceName:e.entityType.defaultResourceName,entityState:e.entityAspect.entityState.name,originalValuesMap:y,autoGeneratedKey:r},o=n.getRequest(o,e,a)})),o.saveOptions={tag:a.saveOptions.tag},n.done(o.entities),o},n.prototype._prepareSaveResult=function(e,a){var n=e.dataService.jsonResultsAdapter||this.jsonResultsAdapter,r=n.extractSaveResults(a)||[],i=n.extractKeyMappings(a)||[],p=n.extractDeletedKeys&&n.extractDeletedKeys(a)||[];return i.length&&(i=i.map((function(e){if(e.entityTypeName)return e;var a=e;return{entityTypeName:t.MetadataStore.normalizeTypeName(a.EntityTypeName),tempValue:a.TempValue,realValue:a.RealValue}}))),p.length&&(p=p.map((function(e){return e.entityTypeName?e:{entityTypeName:t.MetadataStore.normalizeTypeName(e.EntityTypeName),keyValues:e.KeyValue}}))),{entities:r,keyMappings:i,deletedKeys:p}},n}(t.AbstractDataServiceAdapter);t.config.registerAdapter("dataService",n),e.DataServiceWebApiAdapter=n,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=breeze-client-adapter-data-service-webapi.umd.min.js.map